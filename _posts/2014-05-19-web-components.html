---           
layout: post
title: なぜ Web Components はウェブ開発に革命を起こすのか
date: 2014-07-12 14:35:55 UTC
updated: 2014-07-12 14:35:55 UTC
comments: false
categories: Web Components
---

<div class="separator" style="text-align: center;"><object class="BLOGGER-youtube-video" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" data-thumbnail-src="https://ytimg.googleusercontent.com/vi/T5y_lmLngAk/0.jpg" height="315" width="560"><param name="movie" value="https://youtube.googleapis.com/v/T5y_lmLngAk&source=uds&cc_lang_pref=ja&cc_load_policy=1" /><param name="bgcolor" value="#FFFFFF" /><param name="allowFullScreen" value="true" /><embed width="560" height="315"  src="https://youtube.googleapis.com/v/T5y_lmLngAk&source=uds&cc_lang_pref=ja&cc_load_policy=1" type="application/x-shockwave-flash" allowfullscreen="true"></embed></object></div><br /><br />ウェブアプリケーションのフロントエンドに関わる方なら、もう Web Components という言葉を全く聴いたことがない方は少ないのではないでしょか。<br />すでに関連記事も数多く出回っており、実際に触り始めている方も多いと思います。しかし、なぜこれが革命的技術なのか、周囲の人に簡潔に説明できる方はどれくらいいるでしょうか？この記事では、それを試みていきたいと思います。<br /><h2 id="デジタル部品の流通革命">デジタル部品の流通革命</h2>ソフトウェア部品の流通に今、大きな変化が起きてきています。<br /><br />数年前のオープンソース環境を覚えているでしょうか？レポジトリは集中管理型の subversion、リリースは zip、テストは手動。Issue の登録もプロジェクトごとにことなるバグ管理システムが使われていたため、とっつきづらかったでしょうし、パッチを送るのも面倒でした。<br /><br />そんなオープンソースを取り巻く環境が、git や GitHub の登場を皮切りに、目覚ましく発展しています。ネットワークレポジトリの環境が整い、CI (Continuous Integration) によるテストやデプロイの自動化、必要な時に最新のソースコードを手軽にダウンロードできるパッケージマネージャーの充実など、すべてが楽に、しかもスピードを早めてきています。ソフトウェア部品の開発から再利用までのサイクルが分単位まで短縮されることで、コミュニティを介したフィードバックやコントリビュート (Patch / Pull Request) も活性化し、品質を高めていくための仕組みも今までになく効率化しています。オープンソースは、ついに真のエコシステムを手に入れつつあると入っても過言ではないでしょう。<br /><br />この動きは、フロントエンド開発においても大いに役立てられています。特に grunt, npm, bower 等との組み合わせは、だいぶ浸透してきたのではないでしょうか？<br /><h2 id="uiコンポーネントのエコシステム">UI コンポーネントのエコシステム</h2>これまでに最も大きな成功を収めたフロントエンド向けソフトウェアに <a href="http://jquery.com/">jQuery</a> があります。DOM 操作だけでなく、簡単に複雑な UI を実現できる <a href="http://jqueryui.com/">jQuery UI</a> のようなプラグインを活用している開発者の方は多いと思います。カレンダーのUI (Datepicker) や、タブインターフェース、ダイアログといった、素の HTML が苦手とするユーザーインターフェースを実装する敷居を大きく下げてくれたのも、jQuery UI でした。<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-GoHPt1aa4Ko/U3oPR4DsaOI/AAAAAAAAsPA/xxC4YVCyb0s/s1600/jquery-ui-delta.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-GoHPt1aa4Ko/U3oPR4DsaOI/AAAAAAAAsPA/xxC4YVCyb0s/s1600/jquery-ui-delta.png" height="226" width="400" /></a></div><br /><br />もちろん、その対抗馬となる UI ライブラリもたくさん登場しています。Kendo UI, ExtJS, Dojo, Bootstrap など、数え上げればキリがありません。しかしひとつ言えるのは、それぞれに独自の思想や作法があるということです。そのため、実際に使うには、API よりも、まずは思想と作法を学ぶところからスタートしなければなりません。<br />また、選択肢が多いということは、人それぞれに得意なライブラリや好みが別れてしまうため、プロジェクトでひとつを選択する必要に迫られた場合、誰かが妥協したり、新たな学習コストがかかってしまうことも、忘れてはいけません。<br /><h2 id="webcomponents">Web Components</h2>それでは、UI ライブラリが同じ思想、作法で使えるようになるとしたらどうでしょうか？別に言い方をするなら、「UI コンポーネントの思想と作法が標準化されるとしたら」。<br /><br />その答えが、 <a href="http://webcomponents.org/">Web Components</a> です。Web Components には以下のような特徴があります。<br /><ul><li><strong>ウェブ標準</strong>になる予定</li><li>既存の HTML / CSS / JavaScript の知識の延長で使える</li><li><strong>UI コンポーネントを HTML タグ</strong>として作ることができる</li><li>コンポーネントは<strong>カプセル化されるため、外部を汚染しない</strong></li><li><strong>再利用</strong>が可能</li><li>分業がしやすい</li></ul>理屈で説明されるより、実際に動くものを見たほうが話は早いでしょう。簡単な例をご紹介します。<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://agektmr.github.io/webaudio-controls/sample1.html" target="_blank"><img border="0" src="http://3.bp.blogspot.com/-S7lGeyTaSj0/U3oPRGV-xJI/AAAAAAAAsO0/ZcSH2kFqkcI/s1600/Screen+Shot+2014-05-19+at+13.32.44.png" height="196" width="400" /></a></div><br /><br />画像をクリックすると<a href="http://agektmr.github.io/webaudio-controls/sample1.html">実際に動作するデモ</a>を見ることができます。このデモの<a href="https://github.com/WebMusicDevelopersJP/webaudio-controls">ソースコードはこちら</a>。<br />この見た目にかっこいいノブ類ですが、Web Components (Polymer) で作られています。<br />ドラッグして上下に動かすことで、パラメータを増減。<code>Shift</code> キーを押しながらドラッグすれば、1 ずつ動かすことができます。そして、変更したパラメータは <code>value</code> に設定されます。<br /><pre class="brush:html;">&lt;webaudio-knob diameter="64" max="100" sprites="100" src="img/LittlePhatty.png" step="1" style="left: 128px; position: absolute; top: 76px;" tooltip="Knob2 tooltip" value="50"&gt;&lt;/webaudio-knob&gt;<br /></pre>何よりも、ソースを見てみると、これらの要素には、&lt;<code>webaudio-knob&gt;</code> というタグが使われていることに気付くと思います。ノブの見た目や値の範囲は、ネイティブな HTML 要素のお作法に則り、属性を使って変更することができます。<br /><br />注目していただきたいのは、<code>head</code> タグ内にある<br /><pre class="brush: html;">&lt;link href="webcomponents/webaudio-controls.html" rel="import"&gt;&lt;/link&gt;<br /></pre>の部分です。この一行が、<code>&lt;webaudio-knob&gt;</code> の利用を可能にしています (実際には Polyfill の platform.js も読み込んでいます)。JavaScript 一切なしで、HTML タグだけでこれが実現できるとしたら、お手軽だと思いませんか？<br /><br />Web Components が主流になれば、ユーザーは UI コンポーネントを、思想や作法を気にせず、ネイティブの DOM 要素と同様に扱うことができるのです。<br /><h2 id="もう少し具体例が見たい">もう少し具体例が見たい</h2>分かりやすい一例としては、<a href="https://github.com/zenorocha/twitter-button">Twitter Button</a> なんていかがでしょうか？<code>&lt;twitter-button&gt;&lt;/twitter-button&gt;</code>&nbsp;として、必要な情報は属性として与えれば、Twitter ボタンを表示することができます。Twitter ボタンを実装したことがある方であれば、これがいかに楽な作業かわかると思います。<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-poErBXaS0QM/U3oPREvTnYI/AAAAAAAAsOw/g635hFv-EFE/s1600/687474703a2f2f7a6e6f2e696f2f517475532f747769747465722d656c656d656e742e706e67.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-poErBXaS0QM/U3oPREvTnYI/AAAAAAAAsOw/g635hFv-EFE/s1600/687474703a2f2f7a6e6f2e696f2f517475532f747769747465722d656c656d656e742e706e67.png" /></a></div><br /><br />また、<a href="http://customelements.io/">customelements.io</a> というサイトでは、これも含めて、公開されている Web Components でできた UI コンポーネントを探すことができます。<br /><br />うってつけのビデオもあります。先日 Google で開催された <a href="http://www.meetup.com/sfhtml5/events/169452272/">All About Polymer</a> というイベントで <a href="https://plus.google.com/+RobDodson/posts">Rob Dodson</a> が Google Map を使ったアプリのライブコーディングを披露しました。ほとんどタグを追加するだけで派手なアプリが作り上げられていく様は圧巻です。ちなみに英語ですが字幕付きですので、英語の勉強も兼ねて、ぜひ見てみて下さい。<br /><br /><iframe allowfullscreen="" frameborder="0" height="315" src="//www.youtube.com/embed/75EuHl6CSTo" width="560"></iframe> <br /><h2 id="webcomponentsの構成要素">Web Components の構成要素</h2>少し技術的な解説をします。Web Components は、大きく 4 つのテクノロジーで構成されています。<br /><ul><li>Custom Elements</li><li>HTML Imports</li><li>Template</li><li>Shadow DOM</li></ul>各テクノロジーについて、簡単に説明してみましょう。<br /><h3 id="customelements">Custom Elements</h3>独自タグをブラウザに認識させます。<br />このタグはプロパティやメソッド、イベントを持つことができるため、ネイティブな DOM 要素と同様な使い勝手を実現することができます。<br />上記 <code>&lt;webaudio-knob&gt;&lt;/webaudio-knob&gt;</code> の例で言えば<br /><pre class="brush:js;">var knob = document.querySelectorAll('webaudio-knob')[0];<br />knob.setValue(100);<br /></pre>とすることで、JavaScript から 命令的 (declarative - 宣言的 の反対である imperative 的) に、<code>value</code> を変更することができます。<br /><pre class="brush:js;">knob.value = 100;<br /></pre>とすることもできます。<br /><br />実は Custom Elements は GitHub で既に使われてたりします。<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/--2iDG5Utfx8/U3oPRLoIwrI/AAAAAAAAsOs/1RaBIcB4egA/s1600/Screen+Shot+2014-05-19+at+18.28.12.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/--2iDG5Utfx8/U3oPRLoIwrI/AAAAAAAAsOs/1RaBIcB4egA/s1600/Screen+Shot+2014-05-19+at+18.28.12.png" height="171" width="640" /></a></div><br />DevTools で見てみると<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-xJAxVXmp534/U3oPR13ZjrI/AAAAAAAAsO8/-b_sUpEVTF4/s1600/Screen+Shot+2014-05-19+at+18.39.14.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-xJAxVXmp534/U3oPR13ZjrI/AAAAAAAAsO8/-b_sUpEVTF4/s1600/Screen+Shot+2014-05-19+at+18.39.14.png" height="96" width="640" /></a></div><ul><li><code>time</code> タグを拡張 (<code>is="relative-time"</code>) して、タグ中に表示される時間を相対的にしている</li><li><code>title-format</code> 属性を使って、ツールチップ表示の日時にフォーマットを指定している</li></ul>なんて使い方をしているようです。<br /><br />未対応ブラウザ向けには、<a href="https://github.com/Polymer/CustomElements">Polymer の Custom Elements の Polyfill</a> も<a href="https://twitter.com/joshpeek/status/464153518169792513">使っているようです</a>。なんか見てたらホレボレしてきました。<br /><h3 id="template">Template</h3>標準のテンプレート機能を提供します。<br />template のコンセプトは長らく検討されてきました。最近では Handlebar.js や Backbone.js (Underscore), AngularJS のテンプレートが人気ですが、それのウェブ標準版と思って下さい。既存のハックと比べると<br /><ul><li>どこに置いても template 内は DOM と認識されないので、それだけでは中の script を実行したり、画像を取りに行ったりといったことが起きない</li><li>取り込む際は文字列ではなく DOM として認識できるので、扱いやすい</li></ul>など、できそうでできなかった機能が提供されています。なお、プレースホルダーやバインディングの機能はこれ自体提供していない点に注意してください。<br /><h3 id="htmlimports">HTML Imports</h3>ひとつのタグで複数のリソースを読み込むことができます。<br />jQuery UI にしろ Bootstrap にしろ、JavaScript、CSS などを、それぞれ別々に取り込む必要がありました。import タグを使えば、これひとつで UI コンポーネントと、それに必要なリソースを取り込むことができるようになります。<br /><h3 id="shadowdom">Shadow DOM</h3>カプセル化した HTML 要素を追加できます。<br />パッと見の効果は、見えないマークアップを追加できることですが、もっと大きな役割はカプセル化できることです。UI ライブラリでありがちな落とし穴は<br /><ul><li>同じクラス名を使って意図しない要素にスタイルが当てられてしまう</li><li>別の要素に当てたスタイルが意図しない箇所に影響を与えてしまう</li></ul>ですが、Shadow DOM は外の世界と中の世界を分断することで、カプセル化を可能にします。<br /><h2 id="ブラウザベンダーのスタンス">ブラウザベンダーのスタンス</h2>標準化を目指していると言いましたが、ブラウザベンダーの足並みが揃わなければ標準化することはできません。しかし、各ブラウザベンダーは、いずれも Web Components に注目し、実装と仕様策定を同時並行で進めています。<br /><h3 id="google">Google</h3>Google は Web Components で最も大きな役割を担っています。仕様作成者はいずれも Google エンジニアで、Google Chrome では既にほとんどの機能を実装しており、バージョン 36 では HTML Imports も取り込まれ、すべての機能が <code>about:flags</code> のフラグ無しで動く状態になる見込みです。<br />また、まだアルファ版ではありますが、Web Components をベースにした <a href="http://www.polymer-project.org/">Polymer</a> というフレームワークを開発しており、完成すれば、その上で様々なコンポーネントを動かせるよう準備を進めています。同時に、Polymer の開発に当たり、Web Components 未対応ブラウザでの動作が行えるよう <a href="https://github.com/Polymer/platform">platform.js</a> という Polyfill (JavaScript で機能をエミュレートするライブラリ) の開発も進められています。<br /><h3 id="mozilla">Mozilla</h3>Google の次に積極的に Web Components に取り組んでいるのは、間違いなく Mozilla です。<a href="http://www.x-tags.org/">x-tag</a> というフレームワークを開発しており、UI コンポーネント集 <a href="http://mozilla.github.io/brick/">Brick</a> も公開されています。<br /><h3 id="apple">Apple</h3>Blink が WebKit から fork された時点で Shadow DOM が削除されるなど、一時は Web Components への対応に否定的と見られましたが、<a href="https://lists.webkit.org/pipermail/webkit-dev/2014-February/026251.html">先日別ブランチ上で開発を進めることが発表</a>され、様子を伺いつつも興味を示しています。<br /><h3 id="microsoft">Microsoft</h3>Microsoft の Web Components 対応は、<a href="http://status.modern.ie/">status.modern.ie</a> を見る限り、いずれの機能も Under Consideration の状態ですが、<a href="http://www.w3.org/TR/html-templates/">HTML Templates の仕様に関わる</a>など、興味を示しています。<br /><h2 id="ユースケース">ユースケース</h2>どのような場面で Web Components を使うことができるでしょうか？いくつか例を挙げてみます。<br /><h3 id="プロダクト専用のuiコンポーネントを作る">プロダクト専用の UI コンポーネントを作る</h3>サービスを開発するに当たり、UI のコンポーネント化を想定して設計します。そうすることで、UI コンポーネントを作るチームは、その機能に集中することができますし、使うチームは、想定通りにインターフェースが使える前提で開発を進めることができます。分業が楽になるのも Web Components の利点のひとつです。<br /><h3 id="複数サービスで共有のuiコンポーネントを作る">複数サービスで共有の UI コンポーネントを作る</h3>ポータルサイトや、複数のサービスが統合されたサイトを運営している企業の場合、テーマや UI を統一したいケースが多いと思います。それこそ Web Components が威力を発揮するチャンスです。共通サーバーから CSS や画像を配信するインフラは既に整っているところが多いでしょうから、それを Web Components のものに差し替えることで実現できるでしょう。<br /><h3 id="公開されているuiコンポーネントを使う">公開されている UI コンポーネントを使う</h3>ちょっとしたサービスを個人で作りたい場合、開発者がデザインまで手がけるのはなかなか大変です。Bootstrap のように、お手軽にできあいのデザインで UI が組めるのはありがたいですが、Web Components を使えば、もう少し複雑なことも比較的簡単に実現できます。公開されている Web Components のライブラリを <a href="http://customelements.io/">customelements.io</a> などで探し、再利用することで、開発の工数を大幅に減らすことができるようになるでしょう。まだまだ数は少ないですが、Web Components が広まれば、むしろ自分が必要なものを探す方が大変になるかもしれません。<br /><h2 id="どこで学べばいいのか">どこで学べばいいのか</h2>ここまで読んで、ぜひ Web Components を使いたい！と思った方は、どこで使い方を学べばいいのでしょう？仕様を読んで下さい…というと大変ですよね。仕様は仕様なので、使い方が書いてあるわけではありません。幸いなことに、HTML5Rocks にはすでにたくさんの記事が上がっています。これらの記事はメンテされていますので、最新の仕様 (実装) に則っていると思って大丈夫です。<br /><br />でも HTML5Rocks の記事は英語だから読むのが大変・・・そんな方のために、日本語訳しておきました。<br /><ul><li><a href="http://www.html5rocks.com/ja/tutorials/webcomponents/customelements/">Custom Elements - HTML に新しい要素を定義する</a></li><li><a href="http://www.html5rocks.com/ja/tutorials/webcomponents/template/">HTML で利用可能になった Template タグ - クライアントサイドのテンプレートの標準化</a></li><li><a href="http://www.html5rocks.com/ja/tutorials/webcomponents/imports/">HTML Imports - ウェブのための #include</a></li><li><a href="http://www.html5rocks.com/ja/tutorials/webcomponents/shadowdom/">Shadow DOM 101</a></li><li><a href="http://www.html5rocks.com/ja/tutorials/webcomponents/shadowdom-201/">Shadow DOM 201 - CSS とスタイリング</a></li><li><a href="http://www.html5rocks.com/ja/tutorials/webcomponents/shadowdom-301/">Shadow DOM 301 - 上級者向けコンセプトと DOM API</a></li></ul><h2 id="その他日本語資料">その他日本語資料</h2><ul><li><a href="http://liginc.co.jp/web/html-css/html/58267">Web開発者に革命をもたらす！「Web Components」超入門<br /></a>検索で一番にヒットする LIG の王さんの記事ですが、残念ながらこの時からだいぶ仕様が変わってしまっています。とはいえ大枠を把握するにはとてもよい資料だと思いますので、ぜひ目を通すとよいと思います。</li><li><a href="http://ameblo.jp/ca-1pixel/entry-11815188808.html">Web Componentsで行うHTMLのコンポーネント化<br /></a>サイバーエージェントの @1000ch の記事です。最近の記事ですので、仕様的にも新しいものに対応しており、安心して読めると思います。</li><li><a href="http://www.youtube.com/watch?v=GCw4fJEEVe8">Web をまともにしたいので Shadow DOM と Web Components をつくってます<br /></a>Google Japan のエンジニアかつ、Shadow DOM 仕様のエディタであり、Blink 上での Shadow DOM の実装をリードしている <a href="https://plus.google.com/+HayatoIto/posts">Hayato Ito</a> が昨年の HTML5 Conference で行った講演のビデオです。</li><li><a href="http://steps.dodgson.org/b/2013/05/19/polymer-and-web-components/">Polymer と Web Components<br /></a>Web Components 関連の Google エンジニアによる 2013 年の記事。Web Components はもちろんですが、Polymer のコンセプトなどについても書かれています。</li></ul><h2 id="質問はどこに？">質問はどこに？</h2>日本語なら、<a href="https://groups.google.com/group/html5-developers-jp">html5j のメーリングリスト</a>で聞けば、誰かしら答えてくれると思います。英語であれば、<a href="http://stackoverflow.com/questions/tagged/polymer">StackOverflow で polymer タグを使う</a>と良いと思います。<br /><h2 id="まとめ">まとめ</h2>僕なら、誰かに Web Components は何がそんなに素晴らしいのか？と聞かれたら、こう答えます：<br /><br /><strong>Web Components はウェブの UI コンポーネントを標準化し、エコシステムに乗ることで、開発効率を飛躍的に向上する技術 だからであると。</strong><br /><strong><br /></strong>みなさんが素敵な UI コンポーネントを公開してくださるのを楽しみにしています。